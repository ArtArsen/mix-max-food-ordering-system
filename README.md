# Food Ordering System

Веб-система управления заказами для кафе с полным циклом обработки от клиента до доставки.

## Описание проекта

Платформа разработана для автоматизации процесса приёма и обработки заказов в кафе. Система обеспечивает взаимодействие между клиентами, поварами и курьерами через отдельные интерфейсы с real-time обновлением статусов.

### Бизнес-процесс

1. Клиент оформляет заказ на сайте (выбор блюд, адрес, время)
2. Заказ поступает на кухню в панель повара
3. Повар отмечает статус "Готовится"
4. После завершения повар отмечает "Готов" — заказ появляется у курьеров
5. Курьер принимает заказ и доставляет клиенту
6. Альтернативный сценарий: самовывоз из кафе

Клиент видит текущий статус заказа в реальном времени на странице отслеживания.

---

## Функциональные возможности

### Клиентская часть
- Каталог блюд с изображениями и ценами
- Корзина с динамическим расчётом суммы
- AJAX-отправка заказа без перезагрузки страницы
- Выбор типа получения: доставка или самовывоз
- Указание времени получения заказа
- Страница отслеживания с автообновлением статуса
- Валидация номера телефона (форматы КР)

Фото -
<img width="1901" height="903" alt="Demo1" src="https://github.com/user-attachments/assets/c580f9bb-9337-4295-8422-fdd8e1c7dd16" />

### Панель повара (защищённый доступ)
- Аутентификация по уникальному коду
- Просмотр очереди новых заказов
- Управление статусами: "В очереди" → "Готовится" → "Готов"
- Отображение состава заказа, адреса доставки, комментариев
- Real-time обновление списка заказов (AJAX polling)

Фото -
<img width="1917" height="899" alt="Demo2" src="https://github.com/user-attachments/assets/18367a47-2608-431e-a626-21e4fd34e24c" />

### Панель курьера (защищённый доступ)
- Аутентификация по уникальному коду
- Список доступных заказов на доставку
- Принятие заказа в работу (блокировка для других курьеров)
- Отображение адреса, телефона клиента, суммы заказа
- Обновление статуса до "Выполнен" после доставки

Фото -
<img width="1919" height="906" alt="Demo3" src="https://github.com/user-attachments/assets/7573f93d-3e70-4254-a4df-089cf19d7f97" />

### Административная панель Django
- Управление меню (добавление/редактирование блюд)
- Просмотр всех заказов с фильтрацией
- Управление доступом поваров и курьеров
- Статистика заказов через кастомную админку
- История доставок по каждому курьеру

Фото: 
<img width="1892" height="902" alt="Demo4" src="https://github.com/user-attachments/assets/7043d83a-e6e2-409a-86ef-b0bef02e0f5e" />

<img width="1899" height="904" alt="Demo5" src="https://github.com/user-attachments/assets/ed575a9a-e1e2-48e2-a1ed-f432f6b8f8be" />

### Дашборд владельца
- Выручка за день/неделю/месяц
- Количество заказов по периодам
- График продаж за неделю
- Топ-5 популярных блюд
- Распределение заказов по времени суток
- Статистика активности курьеров

Фото -
<img width="1899" height="894" alt="Demo6" src="https://github.com/user-attachments/assets/f3bfc6cd-0af4-4d1a-957a-b92b73ffb2e3" />

---

## Технологический стек

| Технология | Назначение |
|------------|-----------|
| Python 3.11+ | Язык программирования |
| Django 5.2 | Backend-фреймворк |
| Django ORM | Работа с базой данных |
| SQLite | База данных (для разработки) |
| HTML/CSS/JavaScript | Frontend |
| Fetch API | AJAX-запросы без перезагрузки |
| django-ratelimit | Защита от спама (rate limiting) |

---

## Установка и запуск

### Требования
- Python 3.11 или выше
- pip (менеджер пакетов Python)

### Шаги установки

#### 1. Клонирование репозитория
```bash
git clone https://github.com/ArtArsen/mix-max-food-ordering-system.git
cd mix-max-food-ordering-system
```

#### 2. Создание виртуального окружения
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

#### 3. Установка зависимостей
```bash
pip install -r requirements.txt
```

#### 4. Настройка переменных окружения
```bash
# Скопируйте шаблон
cp .env.example .env

# Отредактируйте .env и укажите SECRET_KEY
# Для генерации нового ключа:
python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
```

Пример `.env`:
```
SECRET_KEY=django-insecure-ваш-сгенерированный-ключ
DEBUG=True
```

#### 5. Применение миграций
```bash
python manage.py migrate
```

#### 6. Создание суперпользователя
```bash
python manage.py createsuperuser
```

#### 7. Создание повара и курьера (через админку)
```bash
python manage.py runserver
```

Откройте http://127.0.0.1:8000/admin и создайте:
- **Повара** в разделе "Повара" (укажите имя и код доступа)
- **Курьера** в разделе "Курьеры" (укажите имя, телефон и код доступа)

#### 8. Добавление товаров в меню
В админ-панели перейдите в раздел "Products" и добавьте блюда с изображениями.

#### 9. Запуск сервера
```bash
python manage.py runserver
```

### Доступные URL

- **Главная страница (клиент):** http://127.0.0.1:8000
- **Админ-панель:** http://127.0.0.1:8000/admin
- **Панель повара:** http://127.0.0.1:8000/chef/login/
- **Панель курьера:** http://127.0.0.1:8000/courier/login/
- **Дашборд владельца:** http://127.0.0.1:8000/xjf8k2n9s/

---

## Структура проекта
```
mix-max-food-ordering-system/
│
├── shkarik/                    # Основное приложение
│   ├── models.py               # Модели: Product, Order, OrderItem, Chef, Courier
│   ├── views.py                # Логика обработки запросов
│   ├── admin.py                # Кастомизация админ-панели
│   ├── urls.py                 # Маршруты приложения
│   ├── templates/shkarik/      # HTML-шаблоны
│   │   ├── index.html          # Главная страница (меню)
│   │   ├── cart.html           # Корзина
│   │   ├── order_success.html  # Страница отслеживания заказа
│   │   ├── chef.html           # Панель повара
│   │   ├── courier_orders.html # Панель курьера
│   │   └── owner_dashboard.html # Дашборд владельца
│   └── static/shkarik/         # CSS, JavaScript, изображения
│
├── main/                       # Настройки проекта
│   ├── settings.py             # Конфигурация Django
│   ├── urls.py                 # Главные маршруты
│   └── wsgi.py                 # WSGI для деплоя
│
├── manage.py                   # Управление проектом
├── requirements.txt            # Зависимости
├── .gitignore                  # Исключения для Git
├── .env.example                # Шаблон переменных окружения
└── README.md                   # Документация
```

---

## Архитектура базы данных

### Модель Product (Товар)
```python
name            # Название блюда
description     # Описание
price           # Цена (в сомах)
image           # Изображение товара
available       # Доступен ли товар
```

### Модель Order (Заказ)
```python
secret_code     # Уникальный секретный код для клиента
public_code     # Публичный код для внутреннего использования
client_name     # Имя клиента
client_phone    # Телефон клиента
delivery_type   # Тип: 'pickup' (самовывоз) или 'delivery' (доставка)
address         # Адрес доставки
scheduled_time  # Желаемое время получения
comment         # Комментарий к заказу
total_price     # Общая сумма
status          # Статус: new, cooking, ready, delivering, completed, cancelled
accepted_by     # Код курьера, принявшего заказ
created_at      # Дата и время создания
```

### Модель OrderItem (Позиция заказа)
```python
order           # Связь с заказом
product_name    # Название товара
product_price   # Цена на момент заказа
quantity        # Количество
```

### Модель Chef (Повар)
```python
name            # Имя повара
code            # Уникальный код для входа
is_active       # Активен ли доступ
created_at      # Дата создания
```

### Модель Courier (Курьер)
```python
name            # Имя курьера
code            # Уникальный код для входа
phone           # Телефон курьера
is_active       # Активен ли доступ
created_at      # Дата создания
```

---

## Особенности реализации

### Безопасность
- Аутентификация поваров и курьеров по уникальным кодам (без создания пользователей Django)
- CSRF-защита для всех POST-запросов
- Rate limiting для защиты от спама (10 заказов/минуту с одного IP)
- Валидация всех входящих данных на сервере
- Секретные коды заказов для предотвращения подбора

### Производительность
- AJAX для обновления данных без перезагрузки страницы
- Индексация базы данных по часто запрашиваемым полям
- Кеширование для rate limiting
- Ограничение выборки заказов (последние 50 для повара, 20 для курьера)

### UX/UI
- Адаптивный дизайн (мобильные устройства и десктоп)
- Модальные окна для подтверждения действий
- Real-time обновление статусов заказов
- Визуальная индикация статусов (цветовое кодирование)
- Кнопка для создания скриншота страницы отслеживания

---

## API Endpoints

### Публичные
- `POST /create-order/` — Создание заказа
- `GET /order-success/<secret_code>/` — Отслеживание заказа

### Повар (требуется аутентификация)
- `POST /chef/login/` — Вход повара
- `GET /chef/panel/` — Панель повара
- `GET /api/orders/` — Получение списка заказов
- `POST /api/update/` — Обновление статуса заказа

### Курьер (требуется аутентификация)
- `POST /courier/login/` — Вход курьера
- `GET /courier/orders/` — Панель курьера
- `GET /api/courier/?code=<courier_code>` — Получение доступных заказов
- `POST /api/update/` — Принятие/завершение заказа

### Владелец (только для админов Django)
- `GET /xjf8k2n9s/` — Дашборд с аналитикой

---

## Примеры использования

### Создание заказа (AJAX)
```javascript
fetch('/create-order/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-CSRFToken': getCookie('csrftoken')
  },
  body: JSON.stringify({
    client_name: "Арсен",
    client_phone: "+996700123456",
    delivery_type: "delivery",
    address: "ул. Ленина 45, кв. 12",
    scheduled_time: "18:00",
    comment: "Позвоните за 5 минут",
    cart: [
      {name: "Шаурма", price: 150, quantity: 2},
      {name: "Кофе", price: 50, quantity: 1}
    ]
  })
})
```

### Обновление статуса (Повар)
```javascript
fetch('/api/update/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-CSRFToken': getCookie('csrftoken')
  },
  body: JSON.stringify({
    public_code: "#A1B2",
    status: "cooking"
  })
})
```

---

## Возможные улучшения

- Интеграция с платёжными системами (Элсом, MBank)
- WebSocket для real-time обновлений вместо polling
- Мобильное приложение для курьеров
- Интеграция с картами (Google Maps / 2GIS) для расчёта маршрута
- Telegram-бот для уведомлений клиентов
- Система рейтингов курьеров и блюд
- Программа лояльности для постоянных клиентов
- Экспорт статистики в Excel/PDF
- Автоматический расчёт времени доставки
- История заказов клиента (по номеру телефона)

---

## Разработчик

Проект создан как коммерческий заказ для кафе-шаурмичной в Кызыл-кые, но соглашения сорвались.

**GitHub:** [@ArtArsen](https://github.com/ArtArsen)

---
