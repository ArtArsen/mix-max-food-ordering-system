{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–î–∞—à–±–æ—Ä–¥ ‚Äî SHAKIR & HUMAYRA FOOD</title>
  <link rel="icon" type="image/png" href="{% static 'shkarik/images/logo.png' %}">
  <link rel="stylesheet" href="{% static 'shkarik/css/owner.css' %}">
</head>
<body>
  <header>
    <div class="logo">
      <span class="line1">SHAKIR &</span><br>
      <span class="line2">HUMAYRA</span>
      <span class="line3">FOOD</span>
    </div>
    <nav>
      <a href="{% url 'owner_dashboard' %}" class="active">üìä –î–∞—à–±–æ—Ä–¥</a>
      <a href="/admin/" class="logout">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</a>
    </nav>
  </header>

  <main>
    <div class="page-title">
      <h1>üìä –î–∞—à–±–æ—Ä–¥ –≤–ª–∞–¥–µ–ª—å—Ü–∞</h1>
      <p class="subtitle">–û–±–∑–æ—Ä –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</p>
    </div>

    <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ö–ê–†–¢–û–ß–ö–ò -->
    <section class="stats-grid">
      <!-- –í—ã—Ä—É—á–∫–∞ -->
      <div class="stat-card revenue">
        <div class="stat-icon">üí∞</div>
        <div class="stat-content">
          <h3>–í—ã—Ä—É—á–∫–∞</h3>
          <div class="stat-values">
            <div class="stat-item">
              <span class="label">–°–µ–≥–æ–¥–Ω—è</span>
              <span class="value">{{ revenue_today|floatformat:0 }}</span>
              <span class="currency">—Å–æ–º</span>
            </div>
            <div class="stat-item">
              <span class="label">–ù–µ–¥–µ–ª—è</span>
              <span class="value">{{ revenue_week|floatformat:0 }}</span>
              <span class="currency">—Å–æ–º</span>
            </div>
            <div class="stat-item">
              <span class="label">–ú–µ—Å—è—Ü</span>
              <span class="value highlight">{{ revenue_month|floatformat:0 }}</span>
              <span class="currency">—Å–æ–º</span>
            </div>
          </div>
        </div>
      </div>

      <!-- –ó–∞–∫–∞–∑—ã -->
      <div class="stat-card orders">
        <div class="stat-icon">üì¶</div>
        <div class="stat-content">
          <h3>–ó–∞–∫–∞–∑—ã</h3>
          <div class="stat-values">
            <div class="stat-item">
              <span class="label">–°–µ–≥–æ–¥–Ω—è</span>
              <span class="value">{{ orders_today }}</span>
            </div>
            <div class="stat-item">
              <span class="label">–ù–µ–¥–µ–ª—è</span>
              <span class="value">{{ orders_week }}</span>
            </div>
            <div class="stat-item">
              <span class="label">–ú–µ—Å—è—Ü</span>
              <span class="value highlight">{{ orders_month }}</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- –ì–†–ê–§–ò–ö –ü–†–û–î–ê–ñ -->
    <section class="chart-section">
      <div class="section-header">
        <h3>üìà –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–¥–∞–∂ –∑–∞ –Ω–µ–¥–µ–ª—é</h3>
        <span class="badge">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</span>
      </div>
      <div class="chart-container">
        <canvas id="salesChart"></canvas>
      </div>
    </section>

    <div class="two-column-grid">
      <!-- –¢–û–ü-5 –ë–õ–Æ–î -->
      <section class="top-dishes">
        <div class="section-header">
          <h3>üçî –¢–û–ü-5 –±–ª—é–¥</h3>
          <span class="badge">–ó–∞ –º–µ—Å—è—Ü</span>
        </div>
        {% if top_dishes %}
          <div class="dishes-list">
            {% for dish in top_dishes %}
            <div class="dish-item">
              <div class="dish-rank">{{ forloop.counter }}</div>
              <div class="dish-info">
                <span class="dish-name">{{ dish.name }}</span>
                <span class="dish-stats">{{ dish.quantity }} —à—Ç ‚Ä¢ {{ dish.revenue|floatformat:0 }} —Å–æ–º</span>
              </div>
            </div>
            {% endfor %}
          </div>
        {% else %}
          <p class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>
        {% endif %}
      </section>

      <!-- –ó–ê–ö–ê–ó–´ –ü–û –ß–ê–°–ê–ú -->
      <section class="time-slots">
        <div class="section-header">
          <h3>‚è∞ –ó–∞–∫–∞–∑—ã –ø–æ —á–∞—Å–∞–º</h3>
          <span class="badge">–°–µ–≥–æ–¥–Ω—è</span>
        </div>
        <div class="time-slots-list">
          {% for slot in time_slots %}
          <div class="time-slot">
            <span class="time-label">{{ slot.slot }}</span>
            <div class="progress-bar">
              <div class="progress" data-percent="{{ slot.percent }}"></div>
            </div>
            <span class="time-percent">{{ slot.percent }}% {% if slot.percent > 30 %}üî•{% endif %}</span>
          </div>
          {% endfor %}
        </div>
      </section>
    </div>

    <!-- –ö–£–†–¨–ï–†–´ -->
    <section class="couriers">
      <div class="section-header">
        <h3>üö¥ –ö—É—Ä—å–µ—Ä—ã</h3>
        <span class="badge">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–µ–≥–æ–¥–Ω—è</span>
      </div>
      {% if couriers_stats %}
        <div class="couriers-grid">
          {% for courier in couriers_stats %}
          <div class="courier-card {% if courier.is_active %}active{% endif %}">
            <div class="courier-header">
              <div class="courier-avatar">üë§</div>
              <div class="courier-info">
                <h4>{{ courier.name }}</h4>
                <span class="courier-code">{{ courier.code }}</span>
              </div>
              <div class="courier-status">
                {% if courier.is_active %}
                  <span class="status-badge active">‚úÖ –ê–∫—Ç–∏–≤–µ–Ω</span>
                {% else %}
                  <span class="status-badge inactive">‚ö´ –ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                {% endif %}
              </div>
            </div>
            <div class="courier-stats">
              <div class="stat">
                <span class="stat-label">–î–æ—Å—Ç–∞–≤–æ–∫</span>
                <span class="stat-value">{{ courier.deliveries }}</span>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="no-data">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤</p>
      {% endif %}
    </section>
  </main>

  <!-- –ü–µ—Ä–µ–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Django –≤ HTML -->
  <script id="sales-data" type="application/json">
    {{ sales_by_day|safe }}
  </script>

  <!-- Chart.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <!-- –ù–∞—à JS —Ñ–∞–π–ª -->
  <script src="{% static 'shkarik/js/owner.js' %}"></script>
</body>
</html>